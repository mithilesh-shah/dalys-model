gc()
dalys_scenarios %>%
write_rds("temp.rds")
all_population_df %>%
write_rds("temp.rds")
print("Saving file")
dalys_scenarios %>%
write_rds("temp.rds")
# Compare to benchmark
sy <- start_years[1]
cat <- categories[1]
erad <- erad_opts[1]
grwth <- grwth_opts[1]
brth <- birth_opts[1]
# loop over combos
dalys_scenarios <- tibble()
# Change the start year
for (sy in start_years){
# Which disease category
for (cat in categories){
# How much to eradicate
for (erad in erad_opts){
# Include economic growth
for (grwth in grwth_opts){
# Include new births
for (brth in birth_opts){
# Progress update
print(str_c("Start year ", sy, ", diseases ", cat, ", eradicating ", erad, ", growth ", grwth,
", no births ", brth))
# Define new mortality and disabilty fns
mortality_data$mortality_new <- mortality_data$mortality - erad*mortality_data[,str_c("mortality_",cat)]
disability_data$disability_new <- disability_data$disability - erad*disability_data[,str_c("disability_",cat)]
# Compare scenarios
dalys_compare <- compare_forecasts(population_df, fertility_df, mortality_data, disability_data,
loc_name = "Regions", start_year = sy, end_year = sy+100,
no_births = brth,  fertility_type = "fertility_med",
growth_transitions = grwth)
dalys_scenario <- dalys_compare %>%
mutate(start_year = sy, no_births = brth, growth_transitions = grwth, eradication = erad, diseases = cat) %>%
select(start_year, no_births, growth_transitions, eradication, diseases, location, year,
population_base, population_new, population_mort, population_dis, daly_base, daly_new, daly_mort, daly_dis)
dalys_scenarios <- rbind(dalys_scenarios, dalys_scenario)
}
}
}
print("Saving file")
dalys_scenarios %>%
write_rds("temp.rds")
}
}
dalys_scenarios <- dalys_scenarios %>%
mutate(pop_diff = population_new - population_base, daly_diff = daly_new - daly_base,
pop_diff_mort = population_mort - population_base, daly_diff_mort = daly_mort - daly_base,
pop_diff_dis = population_dis - population_base, daly_diff_dis = daly_dis - daly_base) %>%
mutate(no_births = case_when(no_births == TRUE ~ "current population only", TRUE ~ "with new births"),
growth_transitions = case_when(growth_transitions == TRUE ~ "Economic Growth", TRUE ~ "No Growth"))
dalys_scenarios %>%
write_rds("clean_data/daly_scenarios.rds")
dalys_scenarios %>%
saveRDS("clean_data/daly_scenarios.rds")
daly_summary <- dalys_scenarios %>%
group_by(start_year, no_births, growth_transitions, eradication, diseases, location) %>%
summarise(daly_diff = sum(daly_diff), daly_diff_mort = sum(daly_diff_mort), daly_diff_dis = sum(daly_diff_dis)) %>%
mutate(complimentarity = (daly_diff - daly_diff_mort - daly_diff_dis)/daly_diff)
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = daly_diff, color = diseases))
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = start_year))
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year)))
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = complimentarity, color = diseases, linetype = factor(start_year)))
daly_summary %>%
filter(growth_transitions != "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year)))
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year)))
fertility_type
# Forecast population
forecasts_infant <- forecast_dalys(population_df, fertility_df, mortality_df, disability_df, new = "both",
start_year = start_year, end_year = end_year, end_age = end_age,
no_births = no_births, fertility_type = fertility_type, loc_name = loc_name,
growth_transitions = growth_transitions)
mortality_df$mortality_new <- mortality_df$mortality - 0.75*mortality_df$mortality_infant4
mortality_df %>%
ggplot() + theme_bw() + facet_wrap(~location) +
geom_line(aes(x = age, y = log(mortality)/1e5, group = year, color = year, linetype = "Old")) +
geom_line(aes(x = age, y = log(mortality_new)/1e5, group = year, color = year, linetype = "New"))
# Disability
disability_df$disability_new <- disability_df$disability - 0.75*disability_df$disability_infant4
disability_df %>%
ggplot() + theme_bw() + facet_wrap(~location) +
geom_line(aes(x = age, y = log(disability)/1e5, group = year, color = year, linetype = "Old")) +
geom_line(aes(x = age, y = log(disability_new)/1e5, group = year, color = year, linetype = "New"))
# Forecast population
forecasts_infant <- forecast_dalys(population_df, fertility_df, mortality_df, disability_df, new = "both",
start_year = start_year, end_year = end_year, end_age = end_age,
no_births = no_births, fertility_type = fertility_type, loc_name = loc_name,
growth_transitions = growth_transitions)
forecasts_base %>%
filter(year%%10 == 0) %>%
ggplot(aes(x = age)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = population/1e6, group = as.character(year), color = year)) +
labs(color = "Year") + xlab("Age") + ylab("Population (millions)") + ggtitle("Infant")
dalys_infant4 <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df, loc_name = loc_name,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions)
dalys_infant4 %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
labs(y = "Extra DALYs (millions)", x = "Year", title = "Infant", fill = "")
df %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 1990 & eradication == 0.5 & diseases == "senescent4") %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
df %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 1990 & eradication == 0.5 & diseases == "senescent4") %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 1990 & eradication == 0.5 & diseases == "senescent4") %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year)))
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births != "current population only" &
start_year == 2021 & eradication == 1 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = daly_diff/1e6, color = diseases)) +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 2021 & eradication == 1 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = daly_diff/1e6, color = diseases)) +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births != "current population only" &
start_year == 2021 & eradication == 1 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = daly_diff/1e6, color = diseases)) +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births != "current population only" &
start_year == 2021 & eradication == 1 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location, scales = "free_y") +
geom_line(aes(y = daly_diff/1e6, color = diseases)) +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births != "current population only" &
start_year == 2021 & eradication == 1 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location, scales = "free_y") +
geom_line(aes(y = daly_diff/1e9, color = diseases)) +
labs(y = "Extra DALYs (billions)", x = "Year",  fill = "")
end_age
locations
fertility_types
growth_transitions
infant3_diseases <- cause_tree_df$cause_name[which(cause_tree_df$cluster3 == "Infant")]
adult3_diseases <- cause_tree_df$cause_name[which(cause_tree_df$cluster3 == "Adult")]
senescent3_diseases <- cause_tree_df$cause_name[which(cause_tree_df$cluster3 == "Senescent")]
infant4_diseases <- cause_tree_df$cause_name[which(cause_tree_df$cluster4 == "Infant")]
adult_early4_diseases <- cause_tree_df$cause_name[which(cause_tree_df$cluster4 == "Adult_early")]
adult_late4_diseases <- cause_tree_df$cause_name[which(cause_tree_df$cluster4 == "Adult_late")]
senescent4_diseases <- cause_tree_df$cause_name[which(cause_tree_df$cluster4 == "Senescent")]
# Control parameters here
locations <- unique(all_mortality_df$location)
fertility_types <- c("fertility_est", "fertility_low", "fertility_med", "fertility_high")
start_year <- 2021
end_year <- 2122
end_age <- 100
no_births <- FALSE
fertility_type <- "fertility_med"
growth_transitions <- TRUE
results_df <- data.frame()
for (loc_name in locations[2:5]){
print(paste0("Analysis for ", loc_name))
# Select which region to focus on and which years to use as a starting point
population_df <- filter(all_population_df, location == loc_name)
fertility_df <- filter(all_fertility_df, location == loc_name, year >= start_year)
mortality_df <- create_mortality_df(all_mortality_df, loc_name = loc_name, start_year = start_year, end_year = end_year,
end_age = end_age, growth_transitions = growth_transitions,
income_transition_df = income_transition_df)
disability_df <- create_disability_df(all_disability_df, loc_name = loc_name, start_year = start_year, end_year = end_year,
end_age = end_age, growth_transitions = growth_transitions,
income_transition_df = income_transition_df)
for (fertility_type in fertility_types){
print(paste0("Fertility assumption: ", fertility_type))
for (growth_transitions in c(FALSE, TRUE)){
# Remove infant diseases
mortality_df <- def_mortality_new(mortality_df, infant3_diseases)
disability_df <- def_disability_new(disability_df, infant3_diseases)
dalys_infant3 <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions) %>%
mutate(location = loc_name, intervention = "Infant", fertility_type = fertility_type,
clusters = "3", growth_trans = growth_transitions)
mortality_df <- def_mortality_new(mortality_df, infant4_diseases)
disability_df <- def_disability_new(disability_df, infant4_diseases)
dalys_infant4 <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions) %>%
mutate(location = loc_name, intervention = "Infant", fertility_type = fertility_type,
clusters = "4", growth_trans = growth_transitions)
# Remove adult diseases
mortality_df <- def_mortality_new(mortality_df, adult3_diseases)
disability_df <- def_disability_new(disability_df, adult3_diseases)
dalys_adult3 <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions) %>%
mutate(location = loc_name, intervention = "Adult", fertility_type = fertility_type,
clusters = "3", growth_trans = growth_transitions)
mortality_df <- def_mortality_new(mortality_df, adult_early4_diseases)
disability_df <- def_disability_new(disability_df, adult_early4_diseases)
dalys_adult_early4 <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions) %>%
mutate(location = loc_name, intervention = "Adult_early", fertility_type = fertility_type,
clusters = "4", growth_trans = growth_transitions)
mortality_df <- def_mortality_new(mortality_df, adult_late4_diseases)
disability_df <- def_disability_new(disability_df, adult_late4_diseases)
dalys_adult_late4 <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions) %>%
mutate(location = loc_name, intervention = "Adult_late", fertility_type = fertility_type,
clusters = "4", growth_trans = growth_transitions)
# Remove senescent diseases
mortality_df <- def_mortality_new(mortality_df, senescent3_diseases)
disability_df <- def_disability_new(disability_df, senescent3_diseases)
dalys_senescent3 <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions) %>%
mutate(location = loc_name, intervention = "Senescent", fertility_type = fertility_type,
clusters = "3", growth_trans = growth_transitions)
mortality_df <- def_mortality_new(mortality_df, senescent4_diseases)
disability_df <- def_disability_new(disability_df, senescent4_diseases)
dalys_senescent4 <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions) %>%
mutate(location = loc_name, intervention = "Senescent", fertility_type = fertility_type,
clusters = "4", growth_trans = growth_transitions)
# Slow aging by 10%
mortality_df <- slow_mortality(mortality_df, slow_by = 0.1)
disability_df <- slow_disability(disability_df, slow_by = 0.1)
dalys_slow_10pc <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions) %>%
mutate(location = loc_name, intervention = "Slow_10pc", fertility_type = fertility_type,
clusters = "NA", growth_trans = growth_transitions)
# Slow aging by 25%
mortality_df <- slow_mortality(mortality_df, slow_by = 0.25)
disability_df <- slow_disability(disability_df, slow_by = 0.25)
dalys_slow_25pc <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions) %>%
mutate(location = loc_name, intervention = "Slow_25pc", fertility_type = fertility_type,
clusters = "NA", growth_trans = growth_transitions)
# Append all results
results_df <- rbind(results_df, dalys_infant3, dalys_adult3, dalys_senescent3,
dalys_infant4, dalys_adult_early4, dalys_adult_late4, dalys_senescent4,
dalys_slow_10pc, dalys_slow_25pc)
}
}
}
mortality_df$mortality_new <- mortality_df$mortality - 0.75*mortality_df$mortality_infant4
mortality_df %>%
ggplot() + theme_bw() + facet_wrap(~location) +
geom_line(aes(x = age, y = log(mortality)/1e5, group = year, color = year, linetype = "Old")) +
geom_line(aes(x = age, y = log(mortality_new)/1e5, group = year, color = year, linetype = "New"))
# Disability
disability_df$disability_new <- disability_df$disability - 0.75*disability_df$disability_infant4
disability_df %>%
ggplot() + theme_bw() + facet_wrap(~location) +
geom_line(aes(x = age, y = log(disability)/1e5, group = year, color = year, linetype = "Old")) +
geom_line(aes(x = age, y = log(disability_new)/1e5, group = year, color = year, linetype = "New"))
# Forecast population
forecasts_infant <- forecast_dalys(population_df, fertility_df, mortality_df, disability_df, new = "both",
start_year = start_year, end_year = end_year, end_age = end_age,
no_births = no_births, fertility_type = fertility_type, loc_name = loc_name,
growth_transitions = growth_transitions)
forecasts_base %>%
filter(year%%10 == 0) %>%
ggplot(aes(x = age)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = population/1e6, group = as.character(year), color = year)) +
labs(color = "Year") + xlab("Age") + ylab("Population (millions)") + ggtitle("Infant")
# Compare to benchmark
dalys_infant4 <- compare_forecasts(population_df, fertility_df, mortality_df, disability_df, loc_name = loc_name,
start_year = start_year, end_year = end_year, no_births = no_births,
fertility_type = fertility_type, growth_transitions = growth_transitions)
dalys_infant4 %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
labs(y = "Extra DALYs (millions)", x = "Year", title = "Infant", fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births != "current population only" &
start_year == 2021 & eradication == 1 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location, scales = "free_y") +
geom_line(aes(y = daly_diff/1e9, color = diseases)) +
labs(y = "Extra DALYs (billions)", x = "Year",  fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births != "current population only" &
start_year == 2021 & eradication == 0.5 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location, scales = "free_y") +
geom_line(aes(y = daly_diff/1e9, color = diseases)) +
labs(y = "Extra DALYs (billions)", x = "Year",  fill = "")
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = complimentarity, color = diseases, linetype = factor(start_year)))
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year)))
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 1990 & eradication == 0.5 & diseases == "senescent4") %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 2021 & eradication == 0.5 & diseases == "senescent4") %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location+no_births) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 2021 & eradication == 0.5 & diseases == "senescent4") %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location+no_births, nrow = 1) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
ggsave("figures/scenarios/example_complimentarity_senescent.pdf", width = 7, height = 3)
ggsave("figures/scenarios/example_complimentarity_senescent.pdf", width = 10, height = 3)
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 2021 & eradication == 0.5 & diseases == "senescent4") %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location+no_births, nrow = 1) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "")
ggsave("figures/scenarios/example_complimentarity_senescent.pdf", width = 10, height = 3)
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 2021 & eradication == 0.5 & diseases == "senescent4") %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location+no_births, nrow = 1) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "", title = "50% eradication of ageing-related")
ggsave("figures/scenarios/example_complimentarity_senescent.pdf", width = 10, height = 3)
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births == "current population only" &
start_year == 2021 & eradication == 0.5 & diseases == "infant4") %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location+no_births, nrow = 1) +
geom_line(aes(y = daly_diff/1e6), color = "black") +
geom_bar(aes(y = daly_diff/1e6, fill = "Complimentarity"), stat = "identity") +
geom_bar(aes(y = daly_diff_mort/1e6 + daly_diff_dis/1e6, fill = "Mortality"), stat = "identity") +
geom_bar(aes(y = daly_diff_dis/1e6, fill = "Disability"), stat = "identity") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(y = "Extra DALYs (millions)", x = "Year",  fill = "", title = "50% eradication of infant")
ggsave("figures/scenarios/example_complimentarity_infant.pdf", width = 10, height = 3)
daly_summary <- dalys_scenarios %>%
group_by(start_year, no_births, growth_transitions, eradication, diseases, location) %>%
summarise(daly_diff = sum(daly_diff), daly_diff_mort = sum(daly_diff_mort), daly_diff_dis = sum(daly_diff_dis)) %>%
mutate(complimentarity = (daly_diff - daly_diff_mort - daly_diff_dis)/daly_diff)
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year)))
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~no_births +location, nrow = T, scales = "free_y") +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year))) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs()
daly_summary %>%
filter(growth_transitions == "Economic Growth")
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~no_births +location, nrow = 2, scales = "free_y") +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year))) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs()
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~no_births +location, nrow = 2, scales = "free_y") +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year))) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(y = "Extra DALYs (millions)", x = "Reduction", linetype = "Start year")
ggsave("figures/scenarios/example_complimentarity_infant.pdf", width = 10, height = 6)
ggsave("figures/scenarios/daly_diff_reduction.pdf", width = 10, height = 6)
daly_summary %>%
mutate(location = str_remove(location, "World Bank ")) %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~no_births +location, nrow = 2, scales = "free_y") +
geom_line(aes(x = eradication, y = daly_diff, color = diseases, linetype = factor(start_year))) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(y = "Extra DALYs (millions)", x = "Reduction", linetype = "Start year")
ggsave("figures/scenarios/daly_diff_reduction.pdf", width = 10, height = 6)
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = complimentarity, color = diseases, linetype = factor(start_year)))
daly_summary %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~location+no_births) +
geom_line(aes(x = eradication, y = complimentarity, color = diseases, linetype = factor(start_year))) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(y = "Complimentarity", x = "Reduction", linetype = "Start year")
daly_summary %>%
mutate(location = str_remove(location, "World Bank ")) %>%
filter(growth_transitions == "Economic Growth") %>%
ggplot() + theme_bw() +
facet_wrap(~no_births +location, nrow = 2, scales = "free_y") +
geom_line(aes(x = eradication, y = complimentarity, color = diseases, linetype = factor(start_year))) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(y = "Complimentarity", x = "Reduction", linetype = "Start year")
ggsave("figures/scenarios/comp_reduction.pdf", width = 10, height = 6)
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" & no_births != "current population only" &
start_year == 2021 & eradication == 0.5 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~location, scales = "free_y") +
geom_line(aes(y = daly_diff/1e9, color = diseases)) +
labs(y = "Extra DALYs (billions)", x = "Year",  fill = "")
dalys_scenarios %>%
filter(growth_transitions == "Economic Growth" &
start_year == 2021 & eradication == 1 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~no_births+location, scales = "free_y", ncol = 4) +
geom_line(aes(y = daly_diff/1e9, color = diseases)) +
labs(y = "Extra DALYs (billions)", x = "Year",  fill = "")
dalys_scenarios %>%
mutate(location = str_remove(location, "World Bank ")) %>%
filter(growth_transitions == "Economic Growth" &
start_year == 2021 & eradication == 1 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~no_births+location, scales = "free_y", ncol = 4) +
geom_line(aes(y = daly_diff/1e9, color = diseases)) +
labs(y = "Extra DALYs (billions)", x = "Year",  fill = "")
ggsave("figures/scenarios/daly_diff_overtime.pdf", width = 10, height = 6)
dalys_scenarios %>%
mutate(location = str_remove(location, "World Bank ")) %>%
filter(growth_transitions == "Economic Growth" &
start_year == 2021 & eradication == 1 ) %>%
ggplot(aes(x = year)) + theme_bw() + facet_wrap(~no_births+location, scales = "free_y", ncol = 4) +
geom_line(aes(y = daly_diff/1e9, color = diseases)) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
labs(y = "Extra DALYs (billions)", x = "Year",  fill = "")
ggsave("figures/scenarios/daly_diff_overtime.pdf", width = 10, height = 6)
